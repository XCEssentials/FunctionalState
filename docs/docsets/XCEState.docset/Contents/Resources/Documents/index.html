<!DOCTYPE html>
<html lang="en">
  <head>
    <title>XCEState  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="XCEState  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">XCEState Docs</a> (100% documented)</p>
        <p class="header-right"><a href="https://github.com/XCEssentials/State"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">XCEState Reference</a>
        <img id="carat" src="img/carat.png" />
        XCEState  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/Dispatcher.html">Dispatcher</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enums</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/Transition.html">Transition</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/Transition/Pending.html">– Pending</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Stateful.html">Stateful</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structs</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/State.html">State</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/State/Pending.html">– Pending</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <p><a href="https://github.com/XCEssentials/State/releases"><img src="https://img.shields.io/github/tag/XCEssentials/State.svg" alt="GitHub tag"></a>
<a href="https://cocoapods.org/?q=XCEState"><img src="https://img.shields.io/cocoapods/v/XCEState.svg" alt="CocoaPods"></a>
<a href="https://cocoapods.org/?q=XCEState"><img src="https://img.shields.io/cocoapods/p/XCEState.svg" alt="CocoaPods"></a>
<a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/github/license/XCEssentials/State.svg" alt="license"></a></p>
<h1 id='introduction' class='heading'>Introduction</h1>

<p>Turn any object into discrete system and describe its states declaratively.</p>
<h1 id='how-to-install' class='heading'>How to install</h1>

<p>The recommended way is to install using <a href="https://cocoapods.org/?q=XCEState">CocoaPods</a>:</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'XCEState'</span><span class="p">,</span> <span class="s1">'~&gt; 2.6'</span>
</code></pre>
<h1 id='how-it-works' class='heading'>How it works</h1>

<p>This library allows to turn any object into <a href="https://en.wikipedia.org/wiki/Discrete_system">discrete system</a> by defining a number of distinct states and then applying these states instantly or via transition.</p>
<h1 id='how-to-use' class='heading'>How to use</h1>

<p>A typical use case for this library is for re-configuring instances of <code>UIView</code> and its subclasses as your app state changes.</p>
<h2 id='state' class='heading'>State</h2>

<p>Each state of a given object is represented by two closures. Each of these closures gets an instance of the object as input parameter and supposed to make mutations on internal object members. All such mutations together define a distinct state of the object.</p>

<p>First closure - <code>onSet</code> -  is required and declares mutations that must be made when the object transitions into the state. Second closure - <code>onUpdate</code> - is optional and declares mutations that must be made when the object transitions into the state and when the same state it is being applied again.</p>
<h2 id='stateful' class='heading'>Stateful</h2>

<p>Let&rsquo;s say we have a class that represents a view with a text field where user can input their search keyword and a button that will start the search process when it&rsquo;s tapped:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">SearchView</span><span class="p">:</span> <span class="kt">UIView</span>
<span class="p">{</span>
  <span class="k">let</span> <span class="nv">keyword</span> <span class="o">=</span> <span class="kt">UITextField</span><span class="p">()</span>
  <span class="k">let</span> <span class="nv">start</span> <span class="o">=</span> <span class="kt">UIButton</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>

<p>To declare this class as discrete system, declare its conformance to <code>Stateful</code> protocol:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">SearchView</span><span class="p">:</span> <span class="kt">Stateful</span>
<span class="p">{</span>
  <span class="c1">// optionally lets declare a type alias</span>
  <span class="c1">// to shorten states declaration:</span>
  <span class="kd">typealias</span> <span class="kt">St</span> <span class="o">=</span> <span class="kt">State</span><span class="o">&lt;</span><span class="kt">SearchView</span><span class="o">&gt;</span>
<span class="p">}</span>
</code></pre>

<p><code>Stateful</code> protocol does not require to implement anything, but exclusively provides access to special helper members that allow to declare and later apply states.</p>

<p>To describe a state for a given class, define a class level function (its name will be interpreted as the state name) inside this class that returns a <code>State</code> for this class.</p>

<p>For example, let&rsquo;s define <code>awaiting</code> state for our <code>SearchView</code> class in which both <code>keyword</code> text field and <code>start</code> button are enabled and available for user input. Note that we can define as many input parameters as we want for the function, and this gives us opportunity to pass any kind of values from the outside into the state configuration closure. See how in the example below we can pass default value for <code>keyword</code> field.</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">SearchView</span>
<span class="p">{</span>
    <span class="kd">static</span>
    <span class="kd">func</span> <span class="nf">awaiting</span><span class="p">(</span><span class="n">with</span> <span class="nv">keyword</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">St</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">state</span><span class="p">{</span>

            <span class="nv">$0</span><span class="o">.</span><span class="n">keyword</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">keyword</span>
            <span class="nv">$0</span><span class="o">.</span><span class="n">keyword</span><span class="o">.</span><span class="n">isEnabled</span> <span class="o">=</span> <span class="kc">true</span>
            <span class="nv">$0</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">isEnabled</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Once user has entered search keyword and tapepd <code>start</code> button we may want to lock these controls while search is in progress. To do so, we may want to apply a state <code>locked</code> on the search view, which may be declared as follows:</p>
<pre class="highlight swift"><code><span class="kd">extension</span> <span class="kt">SearchView</span>
<span class="p">{</span>
    <span class="kd">static</span>
    <span class="kd">func</span> <span class="nf">locked</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">St</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">state</span><span class="p">{</span>

            <span class="nv">$0</span><span class="o">.</span><span class="n">keyword</span><span class="o">.</span><span class="n">isEnabled</span> <span class="o">=</span> <span class="kc">false</span>
            <span class="nv">$0</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">isEnabled</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Later in time, we can apply any of the states declared for the class to an instance of this class as follows:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">transition</span><span class="p">:</span> <span class="kt">Transition</span><span class="o">&lt;</span><span class="kt">SearchView</span><span class="o">&gt;.</span><span class="kt">Body</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// define transition</span>
<span class="k">let</span> <span class="nv">view</span> <span class="o">=</span> <span class="kt">SearchView</span><span class="p">()</span>

<span class="n">view</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">apply</span><span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">awaiting</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="s">"something"</span><span class="p">)</span> <span class="p">}</span><span class="o">.</span><span class="nf">instantly</span><span class="p">()</span>
<span class="n">view</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">apply</span><span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">awaiting</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="s">"something"</span><span class="p">)</span> <span class="p">}</span><span class="o">.</span><span class="nf">instantly</span><span class="p">()</span> <span class="c1">// no effect</span>
<span class="n">view</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">apply</span><span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">locked</span><span class="p">()</span> <span class="p">}</span><span class="o">.</span><span class="nf">viaTransition</span><span class="p">()</span> <span class="c1">// with default transition</span>
<span class="n">view</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">apply</span><span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="nf">awaiting</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="s">"after search"</span><span class="p">)</span> <span class="p">}</span><span class="o">.</span><span class="nf">viaTransition</span><span class="p">(</span><span class="n">transition</span><span class="p">)</span>
</code></pre>

<p>It&rsquo;s totally up to developer how to implement transition. When working with <code>UIView</code>-based classes, it&rsquo;s common to apply changes with animations, and <code>Transition</code> typealias gives full control over it.</p>

<p>We also can define transition that should be used by default when we apply a state with transition, but do not provide specific transition explicitly.</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">SearchView</span><span class="p">:</span> <span class="kt">UIView</span>
<span class="p">{</span>
    <span class="c1">//...</span>

    <span class="kd">static</span>
    <span class="k">var</span> <span class="nv">defaultTransition</span><span class="p">:</span> <span class="kt">Transition</span><span class="o">&lt;</span><span class="kt">SearchView</span><span class="o">&gt;.</span><span class="kt">Body</span> <span class="o">=</span> <span class="p">{</span>

        <span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="n">mutations</span><span class="p">,</span> <span class="n">completion</span><span class="p">)</span> <span class="k">in</span>

        <span class="n">view</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1">//===</span>

        <span class="nf">mutations</span><span class="p">()</span> <span class="c1">// this is closure from the state</span>

        <span class="c1">//===</span>

        <span class="kt">UIView</span><span class="o">.</span><span class="nf">animate</span><span class="p">(</span>
            <span class="nv">withDuration</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="nv">animations</span><span class="p">:</span> <span class="p">{</span> <span class="n">v</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="p">},</span>
            <span class="nv">completion</span><span class="p">:</span> <span class="n">completion</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">//...</span>
<span class="p">}</span>
</code></pre>

<p>The listing above demonstrates  default trnasition that hides whole view, then applies mutations from the new state, and then fades in whole view with animation, making it visible again. Alternatively, we could put <code>mutations()</code> call inside <code>animations</code> closure of the <code>UIView.animate(…)</code> call to animate actual mutations during fade-in animation, if so desired.</p>
<h1 id='interoperability-with-objective-c' class='heading'>Interoperability with Objective-C</h1>

<p>To make the result code as concise and self explanatory as possible, as well as to maintaining compile time type safety, this library relies on advanced Swift language features like generics and closure shorthand argument names, so it is NOT intended to be compatible with Objective-C.</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2017 <a class="link" href="https://github.com/maximkhatskevich" target="_blank" rel="external">Maxim Khatskevich</a>. All rights reserved. (Last updated: 2017-06-19)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.8.2</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
